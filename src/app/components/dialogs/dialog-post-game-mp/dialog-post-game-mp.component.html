<!-- // crossrace-ng/src/app/components/dialogs/dialog-post-game-mp/dialog-post-game-mp.component.html -->
<div class="wrapper">
  <div class="d-flex flex-column h-100">
    <div class="row m-lr-auto" style="margin-bottom: 5px">
      <div class="player-card">
        <i class="fa-solid fa-crown crown"></i>
        <div
          [ngStyle]="{ 'background-color': data.winnerColor }"
          class="player-avatar"
        >
          <div class="emoji noselect">{{ data.winnerEmoji }}</div>
        </div>
      </div>
      <div class="d-flex flex-column w-auto" style="height: 80px">
        <h2>{{ data.winnerDisplayName }} won!</h2>
      </div>
    </div>

    <div class="content-container" [@slideContent]="currentView">
      <div class="time m-lr-auto">
        {{ data.time }}
      </div>
      <div class="chess-grid m-lr-auto fade-out-edges">
        @for (row of displayGrid; track row; let i = $index) {
          <div class="grid-row">
            @for (cell of row; track cell; let j = $index) {
              <div
                class="grid-cell noselect"
                [ngClass]="{
                  'letter-tile': cell,
                  'pulsate-fwd-intense': isCellHighlighted(i, j),
                }"
                (click)="cell && onCellClick(i, j)"
              >
                {{ cell ?? "" }}
                @for (
                  exclamation of getExclamationsForCell(i, j);
                  track exclamation.id
                ) {
                  <div
                    class="exclamation-mark"
                    [style.--rand-x]="exclamation.randX"
                    [style.--rand-y]="exclamation.randY"
                    [style.color]="exclamation.color"
                  >
                    !
                  </div>
                }
              </div>
            }
          </div>
        }
      </div>

      <app-leaderboard [players]="gameState.players"></app-leaderboard>
      <div class="navigation-arrows">
        <i class="fa chevron fa-chevron-right" (click)="toggleView()"></i>
        <i class="fa chevron fa-chevron-left" (click)="toggleView()"></i>
      </div>
    </div>

    <div class="action-buttons d-flex">
      <button
        class="btn btn-outline-secondary quit"
        (click)="quit()"
        [disabled]="isNextGameCountdown || isStartingGame"
      >
        Quit
      </button>

      <!-- Host Button -->
      @if (isHost) {
        <button
          class="btn btn-primary start-button"
          (click)="startNextGame()"
          [disabled]="isNextGameCountdown || isStartingGame"
        >
          <span class="button-content">
            {{ isStartingGame ? "Starting" : "Start game" }}
            @if (isNextGameCountdown || isStartingGame) {
              <div class="spinner"></div>
            }
          </span>
        </button>
      }

      <!-- Non-Host Button -->
      @if (!isHost) {
        <button class="btn btn-primary start-button" disabled>
          Waiting for host
        </button>
      }
    </div>
  </div>
</div>
