@if (allowEdit) {
  <div
    class="emoji-mart-container"
    #emojiMartContainer
    [ngClass]="{ visible: editingEmoji }"
  >
    <div class="avatar-tabs">
      <div
        class="tab"
        (click)="selectTab(0)"
        [ngClass]="{ selected: selectedTab === 0 }"
      >
        Avatar
      </div>
      <div
        class="tab"
        (click)="selectTab(1)"
        [ngClass]="{ selected: selectedTab === 1 }"
      >
        Color
      </div>
    </div>

    <div class="emoji-grid" [ngClass]="{ visible: selectedTab === 0 }">
      @for (emoji of emojis; track emoji) {
        <div
          class="emoji-container noselect"
          (click)="selectEmoji(emoji)"
          [class.selected]="emoji === player.playerEmoji"
        >
          <span class="emoji">{{ emoji }}</span>
        </div>
      }
    </div>

    <div class="color-picker" [ngClass]="{ visible: selectedTab === 1 }">
      <div class="color-grid">
        @for (color of colorGrid; track color) {
          <div
            class="color-circle"
            [style.background-color]="color"
            [class.selected]="color === player.playerColor"
            (click)="selectColor(color)"
          ></div>
        }
      </div>
    </div>
  </div>
}

<div class="player-card fade-in">
  <div
    [ngStyle]="{ 'background-color': player.playerColor }"
    class="player-avatar"
    [class.editable]="allowEdit"
    (click)="allowEdit ? editEmoji() : null"
  >
    <div class="emoji noselect">{{ player.playerEmoji }}</div>
    @if (!player.ready) {
      <div class="ready-indicator" [ngClass]="{ ready: player.ready }">
        <i class="fa-solid fa-check"></i>
      </div>
    }
  </div>
  <div class="player-name">
    @if (allowEdit && editingName) {
      <input
        #nameInput
        class="form-control"
        [(ngModel)]="editingNameInput"
        (keyup.enter)="submitName()"
        (blur)="submitName()"
        maxlength="14"
      />
    } @else {
      <span>{{ player.displayName }}</span>
      @if (allowEdit) {
        <i (click)="editName()" class="fa-solid fa-pencil pencil"></i>
        <div class="host-label" [ngClass]="{ transparent: !player.isHost }">
          (Host)
        </div>
      }
    }
  </div>
</div>
