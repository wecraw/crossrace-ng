<div class="container">
  <div class="row justify-content-center">
    <div class="col-md-6 text-center">
      @if (gameState && gameState.gameCode && !joining) {
        <div style="margin-bottom: 5px" class="room-code-label">Room Code:</div>

        <div class="d-flex room-code-row noselect">
          <div
            class="room-code-container m-lr-auto d-flex"
            #copiedTooltip="matTooltip"
            matTooltip="Copied!"
            (mouseenter)="$event.stopImmediatePropagation()"
            (mouseleave)="$event.stopImmediatePropagation()"
          >
            <div class="d-flex code-wrapper" (click)="copyOrShare()">
              @for (letter of gameState.gameCode.split(""); track $index) {
                <div class="tile-wrapper">
                  <div class="letter m-lr-auto">{{ letter }}</div>
                </div>
              }
            </div>
            <div class="copy-share-icon" (click)="copyOrShare()">
              <i
                *ngIf="!isShareSupported"
                class="copy-icon"
                [ngClass]="
                  isCopied ? 'fa-regular fa-circle-check' : 'fa-regular fa-copy'
                "
              ></i>
              <img
                *ngIf="isShareSupported"
                src="assets/share.svg"
                alt="Share icon"
              />
            </div>
          </div>
        </div>
        @if (!reconnectStarted) {
          <div class="self">
            @for (player of players; track $index) {
              @if (isPlayerSelf(player)) {
                <player-card
                  [player]="player"
                  [allowEdit]="true"
                  [playerIndex]="$index"
                  [selectedColor]="player.playerColor"
                  (onNameEdit)="submitName($event)"
                  (onReadyUp)="readyUp()"
                  (onColorSelect)="selectColor($event)"
                  (onEmojiSelect)="selectEmoji($event)"
                ></player-card>
              }
            }
          </div>

          <div class="player-grid">
            @for (player of players; track $index) {
              @if (!isPlayerSelf(player)) {
                <player-card [player]="player" [playerIndex]="$index">
                </player-card>
              }
            }
          </div>

          <button
            class="btn btn-lg btn-primary mt-4"
            color="primary"
            *ngIf="gameState.isHost"
            (click)="startGame()"
            [disabled]="anyNotReady() || players.length < 2"
          >
            Start Game
          </button>
          <button
            class="btn btn-lg btn-outline-secondary mt-4"
            (click)="openTutorialDialog({ mode: 'versus' })"
          >
            How to play
          </button>
        }
      }
    </div>
  </div>
</div>

<!-- <button
  (click)="simulateDisconnect()"
  [disabled]="connectionStatus !== 'connected'"
>
  Simulate Disconnect
</button> -->
